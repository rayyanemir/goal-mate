{% load static %}
<article class="group bg-white rounded-2xl border border-gray-200 hover:shadow-xl transition-all duration-300 overflow-hidden">
  
  <!-- Thumbnail -->
  <div class="aspect-[16/10] relative overflow-hidden rounded-t-2xl">
    {% if product.thumbnail %}
      <img src="{{ product.thumbnail }}" 
           alt="{{ product.name }}" 
           class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
    {% else %}
      <div class="w-full h-full bg-gradient-to-br from-slate-200 via-gray-100 to-slate-200 flex items-center justify-center">
        <div class="text-gray-400 text-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-12 h-12 mx-auto mb-2">
            <rect x="32" y="48" width="192" height="160" rx="8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <line x1="32" y1="80" x2="224" y2="80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <path d="M168,112a40,40,0,0,1-80,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          <div class="text-sm font-medium">No Image</div>
        </div>
      </div>
    {% endif %}
    
    <!-- Category Badge -->
    <div class="absolute top-4 left-4">
      <span class="inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold bg-cyan-500 text-white shadow-lg">
        {{ product.get_category_display }}
      </span>
    </div>
    
    <!-- Status Badges -->
    <div class="absolute top-4 right-4 flex flex-col space-y-2">
      {% if product.is_featured %}
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-amber-400 text-amber-900 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-3 h-3 mr-1">
            <path d="M128,189.09l54.72,33.65a8.4,8.4,0,0,0,12.52-9.17l-14.88-62.79,48.7-42A8.46,8.46,0,0,0,224.27,94L160.36,88.8,135.74,29.2a8.36,8.36,0,0,0-15.48,0L95.64,88.8,31.73,94a8.46,8.46,0,0,0-4.79,14.83l48.7,42L60.76,213.57a8.4,8.4,0,0,0,12.52,9.17Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          Featured
        </span>
      {% endif %}
      
      {% if product.stock <= 5 and product.stock > 0 %}
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-orange-400 text-orange-900 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-3 h-3 mr-1">
            <path d="M136,192c20-3.37,36.61-20,40-40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <path d="M112,96l26.27-72C159.86,41.92,208,88.15,208,144a80,80,0,0,1-160,0c0-30.57,14.42-58.26,31-80Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          Low Stock
        </span>
      {% elif product.stock == 0 %}
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold bg-red-400 text-red-900 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-3 h-3 mr-1">
            <line x1="200" y1="56" x2="56" y2="200" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <line x1="200" y1="200" x2="56" y2="56" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          Out of Stock
        </span>
      {% endif %}
    </div>
    
    <!-- Price overlay -->
    <div class="absolute bottom-4 left-4">
      <div class="bg-white rounded-lg px-3 py-2 shadow-lg">
        <div class="text-lg font-bold text-cyan-600">
          Rp {{ product.price|floatformat:0 }}
        </div>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="p-6">
    
    <!-- Product Meta -->
    <div class="flex items-center justify-between text-sm text-slate-600 mb-3">
      <div class="flex items-center space-x-3">
        {% if product.brand %}
          <span class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 mr-1">
              <path d="M42.34,138.34A8,8,0,0,1,40,132.69V40h92.69a8,8,0,0,1,5.65,2.34l99.32,99.32a8,8,0,0,1,0,11.31L153,237.66a8,8,0,0,1-11.31,0Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <circle cx="84" cy="84" r="12"/>
            </svg>
            {{ product.brand }}
          </span>
        {% endif %}
        <span class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 mr-1">
            <rect x="32" y="48" width="192" height="160" rx="8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <line x1="32" y1="80" x2="224" y2="80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <path d="M168,112a40,40,0,0,1-80,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          Stock: {{ product.stock }}
        </span>
      </div>
      
      {% if product.rating > 0 %}
        <div class="flex items-center space-x-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 text-yellow-500">
            <path d="M128,189.09l54.72,33.65a8.4,8.4,0,0,0,12.52-9.17l-14.88-62.79,48.7-42A8.46,8.46,0,0,0,224.27,94L160.36,88.8,135.74,29.2a8.36,8.36,0,0,0-15.48,0L95.64,88.8,31.73,94a8.46,8.46,0,0,0-4.79,14.83l48.7,42L60.76,213.57a8.4,8.4,0,0,0,12.52,9.17Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          <span class="font-medium">{{ product.rating }}</span>
        </div>
      {% endif %}
    </div>

    <!-- Product Title -->
    <h3 class="text-xl font-bold text-slate-800 mb-3 line-clamp-2 leading-tight group-hover:text-cyan-700 transition-colors duration-300">
      <a href="{% url 'main:show_product' product.id %}" class="hover:text-cyan-600 transition-colors">
        {{ product.name }}
      </a>
    </h3>

    <!-- Product Description -->
    <p class="text-slate-600 text-sm leading-relaxed line-clamp-3 mb-5">
      {{ product.description|truncatewords:20 }}
    </p>

    <!-- Action Buttons -->
    {% if user.is_authenticated and product.user == user %}
      <div class="flex items-center justify-between pt-5 border-t border-gray-200">
        <a href="{% url 'main:show_product' product.id %}" 
           class="inline-flex items-center space-x-2 text-cyan-600 hover:text-cyan-700 font-semibold text-sm bg-cyan-50 hover:bg-cyan-100 px-4 py-2 rounded-lg transition-all duration-300 hover:scale-105">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4">
            <circle cx="56" cy="128" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <circle cx="152" cy="128" r="24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <ellipse cx="176" cy="128" rx="48" ry="88" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <ellipse cx="80" cy="128" rx="48" ry="88" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          <span>View Details</span>
        </a>
        
        <div class="flex space-x-2">
          <a href="{% url 'main:edit_product' product.id %}" 
             class="inline-flex items-center space-x-1 text-slate-600 hover:text-slate-800 text-sm bg-slate-50 hover:bg-slate-100 px-3 py-2 rounded-lg transition-all duration-300 hover:scale-105">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4">
              <path d="M92.69,216H48a8,8,0,0,1-8-8V163.31a8,8,0,0,1,2.34-5.65L165.66,34.34a8,8,0,0,1,11.31,0L221.66,79a8,8,0,0,1,0,11.31L98.34,213.66A8,8,0,0,1,92.69,216Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <line x1="136" y1="64" x2="192" y2="120" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            </svg>
            <span>Edit</span>
          </a>
          
          <a href="{% url 'main:delete_product' product.id %}" 
             class="inline-flex items-center space-x-1 text-red-600 hover:text-red-700 text-sm bg-red-50 hover:bg-red-100 px-3 py-2 rounded-lg transition-all duration-300 hover:scale-105">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4">
              <line x1="216" y1="56" x2="40" y2="56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <line x1="104" y1="104" x2="104" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <line x1="152" y1="104" x2="152" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <path d="M200,56V208a8,8,0,0,1-8,8H64a8,8,0,0,1-8-8V56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
              <path d="M168,56V40a16,16,0,0,0-16-16H104A16,16,0,0,0,88,40V56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            </svg>
            <span>Delete</span>
          </a>
        </div>
      </div>
    {% else %}
      <div class="pt-5 border-t border-gray-200">
        <a href="{% url 'main:show_product' product.id %}" 
           class="inline-flex items-center justify-center w-full space-x-2 text-white font-semibold text-sm bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" class="w-4 h-4 text-white">
            <rect x="32" y="48" width="192" height="160" rx="8" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <line x1="32" y1="80" x2="224" y2="80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
            <path d="M168,112a40,40,0,0,1-80,0" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
          </svg>
          <span>View Product Details</span>
          <span>→</span>
        </a>
      </div>
    {% endif %}
  </div>
</article>

<style>
/* Text truncation utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Simple hover shadow effect */
article:hover {
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

/* Smooth image scaling */
img {
  transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Mobile responsiveness */
@media (max-width: 640px) {
  article {
    margin: 0.5rem;
  }
  
  .p-6 {
    padding: 1rem;
  }
  
  .text-xl {
    font-size: 1.125rem;
  }
  
  .flex.space-x-2 {
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .flex.space-x-2 a {
    width: 100%;
    justify-content: center;
  }
}
</style>